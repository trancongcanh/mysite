{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<title>Stocks Company</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://unpkg.com/gijgo@1.9.13/js/gijgo.min.js" type="text/javascript"></script>
<link href="https://unpkg.com/gijgo@1.9.13/css/gijgo.min.css" rel="stylesheet" type="text/css" />

<style>
* {
  box-sizing: border-box;
}

body {
  font-family: Arial, Helvetica, sans-serif;
}

/* Style the header */
header {
  background-color: #1b62a9	;
  padding: 1.5%;
  /*text-align: center;*/
  font-size: 150%;
  color: white;
}
#table {
  overflow-x: auto;
}

table {
	font-size: 110%;
	padding: 1%;
}

.backgreen {
	background: #a9c38a
}
.numberTextAlign {
	text-align: right
}
article {
  float: left;
  padding: 1%;
  width: 70%;
  background-color: #f1f1f1;
  height: 300px; /* only for demonstration, should be removed */
}

/* Clear floats after the columns */
section::after {
  content: "";
  display: table;
  padding-top: 30px;
  clear: both;
}


/* Responsive layout - makes the two columns/boxes stack on top of each other instead of next to each other, on small screens */
@media (max-width: 600px) {
  nav, article {
    width: 100%;
    height: auto;
  }
}
@media only screen and (max-width: 600px) {
  /* Style the header */
header {
  background-color: #1b62a9	;
  padding: 1.5%;
  padding-top: 5%;
  /*text-align: center;*/
  font-size: 100%;
  color: white;
  
}
::placeholder {
    font-size: 90%;
}
}
.right {
    float: right;
  }
</style>
</head>
<body>
<header>
  <div class="container">
    <!-- Form tìm kiếm -->
    <form action="{% url 'stocks:search' %}" method="POST">
    <!-- Phòng chống csrf -->
    {% csrf_token %}
    <div class="form-group row">
        <div class="right" >
            <div class="col-sm-15">
                {% if log == 1 %}
                    <b style = "color: #be0505">Hi, {{username}}</b>
                    <small style="  background-color: #a9c38a; 
                                border-top-left-radius: 4px;
                                border-bottom-right-radius: 4px;
                                border-bottom-left-radius: 4px;
                                border-top-right-radius: 4px;">
                                <a style="color: white;" href="/stocks">&emsp;Logout&emsp;</a></small>                    
                {% else %}
                    <small style="  background-color: #a9c38a; 
                                border-top-left-radius: 4px;
                                border-bottom-right-radius: 4px;
                                border-bottom-left-radius: 4px;
                                border-top-right-radius: 4px;">
                                <a href="/stocks/signup" url 'register' %}">&emsp;Sign Up&nbsp; </a>|<a href="/stocks/login" url 'login' %}">&nbsp; Login&emsp;</a></small>
                {% endif %}
            </div>
        </div>
    </div>
    <!-- Tìm kiếm theo vốn công ty -->
	  <div class="form-group row">
	    <label class="col-sm-2 col-xs-4 col-form-label">Vốn công ty:</label>
	    <div class="col-sm-7 col-xs-5">
	      <input type="text" class="form-control" id="company_cap" name="company_cap" value="{{company_capital_view}}" placeholder="Nhập số vốn công ty">
	    </div>
	    <div class="col-sm-3 col-xs-3">
	      <label>(Tỷ VNĐ)</label>
	    </div>
	  </div>
    <!-- Số lượng cty muốn tìm kiếm -->
	  <div class="form-group row">
	    <label class="col-sm-2 col-xs-4 col-form-label">Số record:</label>
	    <div class="col-sm-7 col-xs-5">
	      <input type="text" class="form-control" id="count" name="count_company" value="{{count_record_view}}" placeholder="Nhập số record">
	    </div>
	    <div class="col-sm-3 col-xs-3">
	      <label>(Công ty)</label>
	    </div>
	  </div>
    <!-- Tìm kiếm theo ngày cập nhật -->
	    <div class="form-group row">
            <label class="col-sm-2 col-xs-4 col-form-label">Ngày tìm kiếm:</label>
            <div class="col-sm-3 col-xs-5">
                <input id="datepicker" name="date_update" value="{{date_update_view}}" placeholder="dd/mm/yyyy"/>
                <script>
                    $('#datepicker').datepicker({
                        uiLibrary: 'bootstrap',
                        format: 'dd/mm/yyyy'
                    });
                </script>
            </div>
        </div>
    <!-- Button tìm  kiếm -->
	  <div class="form-group row">
	  	<div class="col-sm-2 col-xs-4">
	    </div>
	    <div class="col-sm-1 col-xs-1">
	      <button type="submit" class="btn btn-primary" style = "background: #5c9616">Tìm kiếm</button>
	    </div>
	  </div>
    <!-- Vùng thông báo lỗi -->
      <div style="font-size: 20px; color: #f81919;"  >
        {{ message }}
        {{ message2 }}
        {{ message3 }}
      </div>
	</form>
</div>
<div>
    <small style="  background-color: #a9c38a; 
    border-top-left-radius: 4px;
    border-bottom-right-radius: 4px;
    border-bottom-left-radius: 4px;
    border-top-right-radius: 4px;">
    <a style="color: white;" href="/stocks/export_csv">&emsp;Export Csv&emsp;</a></small> 
</div>

</header>
<div id = "table">
<!-- Danh sách công ty -->
  <table class="table table-bordered table-striped">
    <thead>
      <tr style = "background: #5c9616">
        <th scope="col">No</th>
        <th scope="col">Mã cổ phiếu</th>
        <th scope="col">Tên công ty</th>
        <th scope="col">Vốn công ty (VNĐ)</th>
        <th scope="col">Giá hiện tại</th>
        <th scope="col">ROA(%)</th>
        <th scope="col">PE</th>
        <th scope="col">Mức độ hiệu quả</th>
        <th scope="col">Mua/bán</th>
      </tr>
    </thead>
    <tbody>
      {% if company_list_view %}
          {% for company in company_list_view %}
              {% if len_company == 1  %}
                  <tr>
                      <td scope="row">{{company.id}}</td>
                      <td>{{company.stocks}}</td>
                      <td>{{company.company_name}}</td>
                      <td>{{company.company_cap}}</td>
                      <td>{{company.current_price}}</td>
                      <td>{{company.r_o_a}}</td>
                      <td>{{company.p_e}}</td>
                      <td>{{company.efficiency_level}}</td>
                      {% if log == 0 %}
                        <td><button disabled="true"  class="btn btn-primary" style = "background: #5c9616">Mua</button>&ensp;<button disabled="true" class="btn btn-primary" style = "background: #cfb521">Bán</button></td>
                    {% else %}
                        <td><button  class="btn btn-primary" style = "background: #5c9616">Mua</button>&ensp;<button class="btn btn-primary" style = "background: #cfb521">Bán</button></td>
                    {% endif %}
                    </tr> 
              {% else %}   
                  <tr class="backgreen">
                      <td scope="row">{{company.id}}</td>
                      <td>{{company.stocks}}</td>
                      <td>{{company.company_name}}</td>
                      <td>{{company.company_cap}}</td>
                      <td>{{company.current_price}}</td>
                      <td>{{company.r_o_a}}</td>
                      <td>{{company.p_e}}</td>
                      <td>{{company.efficiency_level}}</td>
                      {% if log == 0 %}
                        <td><button disabled="true"  class="btn btn-primary" style = "background: #5c9616">Mua</button>&ensp;<button disabled="true" class="btn btn-primary" style = "background: #cfb521">Bán</button></td>
                    {% else %}
                        <td><button  class="btn btn-primary" style = "background: #5c9616">Mua</button>&ensp;<button class="btn btn-primary" style = "background: #cfb521">Bán</button></td>
                    {% endif %}                    
                    </tr>
              {% endif %}
          {% endfor %}
      {% else %}
                  <tr>
                      <td colspan="9" align="center" >
                          Không có thông tin công ty cần tìm kiếm.
                      </td>   
                  </tr>                    
      {% endif %}  
    </tbody>
  </table> 
</div>
</body>
</html>
